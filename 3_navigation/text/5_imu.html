<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>IMU - BPC-PRP - Practical Robotics and Computer Vision</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="../../favicon.svg">
                        <link rel="shortcut icon" href="../../favicon.png">
                <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
                <link rel="stylesheet" href="../../css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="../../fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../title-page.html">Introduction</a></li><li class="chapter-item expanded "><a href="../../1_lectures/text/intro.html"><strong aria-hidden="true">1.</strong> Lectures</a></li><li class="chapter-item expanded "><a href="../../2_labs/text/intro.html"><strong aria-hidden="true">2.</strong> Labs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../2_labs/text/1_lab.html"><strong aria-hidden="true">2.1.</strong> Lab 1 - Introduction &amp; Linux Installation</a></li><li class="chapter-item expanded "><a href="../../2_labs/text/2_lab.html"><strong aria-hidden="true">2.2.</strong> Lab 2 - IDE, C++ &amp; CMake</a></li><li class="chapter-item expanded "><a href="../../2_labs/text/3_lab.html"><strong aria-hidden="true">2.3.</strong> Lab 3 - Git &amp; C++ Project Template</a></li><li class="chapter-item expanded "><a href="../../2_labs/text/4_lab.html"><strong aria-hidden="true">2.4.</strong> Lab 4 - Data Capture &amp; Visualization (ROS)</a></li><li class="chapter-item expanded "><a href="../../2_labs/text/5_lab.html"><strong aria-hidden="true">2.5.</strong> Lab 5 - Motor, Kinematics &amp; Gamepad</a></li><li class="chapter-item expanded "><a href="../../2_labs/text/6_lab.html"><strong aria-hidden="true">2.6.</strong> Lab 6 - Line Estimation</a></li><li class="chapter-item expanded "><a href="../../2_labs/text/7_lab.html"><strong aria-hidden="true">2.7.</strong> Lab 7 - Line Following &amp; PID</a></li><li class="chapter-item expanded "><a href="../../2_labs/text/8_lab.html"><strong aria-hidden="true">2.8.</strong> Lab 8 - Exam (Line Following)</a></li><li class="chapter-item expanded "><a href="../../2_labs/text/9_lab.html"><strong aria-hidden="true">2.9.</strong> Lab 9 - Obstacle Detection &amp; Corridor Following</a></li><li class="chapter-item expanded "><a href="../../2_labs/text/10_lab.html"><strong aria-hidden="true">2.10.</strong> Lab 10 - Orientation-Aware Corridor Navigation</a></li><li class="chapter-item expanded "><a href="../../2_labs/text/11_lab.html"><strong aria-hidden="true">2.11.</strong> Lab 11 - Camera Data Processing</a></li><li class="chapter-item expanded "><a href="../../2_labs/text/12_lab.html"><strong aria-hidden="true">2.12.</strong> Lab 12 - Exam (Corridor Following)</a></li><li class="chapter-item expanded "><a href="../../2_labs/text/13_exam.html"><strong aria-hidden="true">2.13.</strong> Main Exam - Maze Escape</a></li></ol></li><li class="chapter-item expanded "><a href="../../3_navigation/text/intro.html"><strong aria-hidden="true">3.</strong> Robotic Topics</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../3_navigation/text/1_differential_chassis.html"><strong aria-hidden="true">3.1.</strong> Differential Chassis</a></li><li class="chapter-item expanded "><a href="../../3_navigation/text/2_pid.html"><strong aria-hidden="true">3.2.</strong> PID</a></li><li class="chapter-item expanded "><a href="../../3_navigation/text/3_line_following.html"><strong aria-hidden="true">3.3.</strong> Line Following</a></li><li class="chapter-item expanded "><a href="../../3_navigation/text/4_corridor_following.html"><strong aria-hidden="true">3.4.</strong> Corridor Following</a></li><li class="chapter-item expanded "><a href="../../3_navigation/text/5_imu.html" class="active"><strong aria-hidden="true">3.5.</strong> IMU</a></li><li class="chapter-item expanded "><a href="../../3_navigation/text/6_maze_escape.html"><strong aria-hidden="true">3.6.</strong> Maze Escape</a></li></ol></li><li class="chapter-item expanded "><a href="../../4_others/text/intro.html"><strong aria-hidden="true">4.</strong> Others</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../4_others/text/1_linux.html"><strong aria-hidden="true">4.1.</strong> Linux</a></li><li class="chapter-item expanded "><a href="../../4_others/text/2_cpp.html"><strong aria-hidden="true">4.2.</strong> C++</a></li><li class="chapter-item expanded "><a href="../../4_others/text/7_cmake.html"><strong aria-hidden="true">4.3.</strong> CMake</a></li><li class="chapter-item expanded "><a href="../../4_others/text/3_git.html"><strong aria-hidden="true">4.4.</strong> Git</a></li><li class="chapter-item expanded "><a href="../../4_others/text/4_clion.html"><strong aria-hidden="true">4.5.</strong> CLion</a></li><li class="chapter-item expanded "><a href="../../4_others/text/8_multithreading.html"><strong aria-hidden="true">4.6.</strong> Multithreading</a></li><li class="chapter-item expanded "><a href="../../4_others/text/9_rviz2_visualizations.html"><strong aria-hidden="true">4.7.</strong> RViz2 Visualizations</a></li><li class="chapter-item expanded "><a href="../../4_others/text/10_coordinate_system.html"><strong aria-hidden="true">4.8.</strong> Coordinate Systems</a></li><li class="chapter-item expanded "><a href="../../4_others/text/11_communication_buses.html"><strong aria-hidden="true">4.9.</strong> Communication Buses</a></li><li class="chapter-item expanded "><a href="../../4_others/text/12_ubuntu_environment.html"><strong aria-hidden="true">4.10.</strong> Ubuntu Environment</a></li></ol></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">BPC-PRP - Practical Robotics and Computer Vision</h1>

                    <div class="right-buttons">
                                                <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="imu-inertial-measurement-unit"><a class="header" href="#imu-inertial-measurement-unit">IMU (Inertial Measurement Unit)</a></h1>
<p>Note: In this tutorial, by the term &quot;gyroscope&quot; we mean an angular rate sensor; strictly speaking, a gyroscope is a device that maintains orientation.</p>
<p>In this tutorial, we will focus on how to process data from an Inertial Measurement Unit (IMU) to estimate orientation and position along a single degree of freedom (DoF). While an actual IMU measures 3-axis accelerations (from an accelerometer) and 3-axis angular velocities (from a gyroscope), we will simplify the problem by considering only one-dimensional motion and rotation. This simplification helps you gain intuition before extending the logic to three dimensions.</p>
<p>Key concepts:</p>
<ul>
<li>Angular velocity to orientation: If you know how fast something is rotating, you can integrate that angular rate over time to find how far it has rotated.</li>
<li>Acceleration to position: If you know the acceleration of something, you can integrate it once to get its velocity, and integrate again to find its position.</li>
</ul>
<p>This tutorial will walk you through the math and give you a step-by-step procedure, along with a conceptual example and code snippets.</p>
<h2 id="sensor-data-and-assumptions"><a class="header" href="#sensor-data-and-assumptions">Sensor Data and Assumptions</a></h2>
<p>An IMU in one dimension can be thought of as providing two main signals:</p>
<ul>
<li>Angular velocity, <code>ω(t)</code>, measured in radians per second <code>(rad/s)</code>. In a real IMU, this would come from the gyroscope (angular speed meter).</li>
<li>Linear acceleration, <code>a(t)</code>, measured in meters per second squared <code>(m/s^2)</code>. In a real IMU, this would come from the accelerometer.</li>
</ul>
<p>Assumptions to Simplify the Task:</p>
<ul>
<li>We assume motion and rotation occur along a single axis.</li>
<li>Gravity effects may be ignored or assumed to be pre-compensated. In practice, you must carefully handle gravity, but for this tutorial, we focus on the mechanics of integration only.</li>
<li>Noise and biases in the sensors are not considered for now. In reality, these need filtering and calibration.</li>
<li>Initial conditions (initial orientation and position) are known.</li>
</ul>
<p>Notation and Variables:</p>
<ul>
<li>Let <code>θ(t)</code> represent the orientation (angle) at time <code>t</code>.</li>
<li>Let <code>x(t)</code> represent the position at time <code>t</code>.</li>
<li>Given data: <code>ω(t)</code> and <code>a(t)</code>.</li>
<li>Known initial conditions: <code>θ(0) = θ</code> and <code>x(0) = x</code>, and possibly initial velocity <code>v(0) = v0</code>.</li>
</ul>
<h2 id="from-angular-velocity-to-orientation"><a class="header" href="#from-angular-velocity-to-orientation">From Angular Velocity to Orientation</a></h2>
<p>Orientation (in 1D, simply an angle) is related to angular velocity by the first-order differential equation:</p>
<p><img src="../images/imu_orientation_diff.png" alt="Derivation of orientation"/></p>
<p>To obtain <code>θ(t)</code>, you integrate the angular velocity over time:</p>
<p><img src="../images/imu_angular_speed_int.png" alt="Integration of angular velocity"/></p>
<p>If you sample <code>ω</code> at discrete time steps <code>tk = kΔt</code> (where <code>Δt</code> is the sampling period), you can approximate the integral numerically. A simple numerical integration (Euler method) is:</p>
<p><img src="../images/imu_orientatoin_int.png" alt="Integration of orientation"/></p>
<p>Here, <code>θk</code> and <code>ωk</code> are the angle and angular velocity at the k-th time step.</p>
<h2 id="from-linear-acceleration-to-position"><a class="header" href="#from-linear-acceleration-to-position">From Linear Acceleration to Position</a></h2>
<p>The position is related to acceleration by two integrations:</p>
<p>Acceleration to velocity:</p>
<p><img src="../images/imu_acc_to_vel.png" alt="Acceleration to velocity"/></p>
<p>Velocity to position:</p>
<p><img src="../images/imu_vel_to_position.png" alt="Velocity to position"/></p>
<p>Combining these, we get:</p>
<p><img src="../images/imu_acc_to_pose.png" alt="Acceleration to position"/></p>
<p>For discrete time steps, using Euler integration:</p>
<p>Update velocity:</p>
<p><img src="../images/imu_discrete_acc_to_speed.png" alt="Acceleration to velocity (discrete)"/></p>
<p>Update position:</p>
<p><img src="../images/imu_discrete_vel_to_pose.png" alt="Velocity to pose (discrete)"/></p>
<p>Note that the velocity used to update the position can be the already updated velocity <code>(vk+1)</code> or the old one <code>(vk)</code>, depending on your numerical integration choice. The simplest Euler method uses the old values:</p>
<p><img src="../images/imu_euler.png" alt="Euler method"/></p>
<p>But for clarity and consistency, you might update position using the updated velocity if you wish (this is a matter of integration scheme choice; either is acceptable for this tutorial).</p>
<h2 id="step-by-step-example"><a class="header" href="#step-by-step-example">Step-by-Step Example</a></h2>
<h3 id="setup"><a class="header" href="#setup">Setup:</a></h3>
<p>Assume a sampling frequency of <code>fs = 100 Hz</code> (<code>Δt = 0.01s</code>).</p>
<p>Suppose we have a constant angular velocity <code>ω = 0.1 rad/s</code> and a constant acceleration <code>a = 0.2 m/s^2</code>. </p>
<p>Initial orientation: <code>θ0 = 0 rad</code>.</p>
<p>Initial velocity: <code>v0 = 0 m/s</code>.</p>
<p>Initial position: <code>x0 = 0 m</code>.</p>
<h3 id="orientation-calculation"><a class="header" href="#orientation-calculation">Orientation Calculation:</a></h3>
<p><code>θk+1 = θk + ωkΔt</code>.</p>
<p>Since <code>ωk = 0.1 rad/s</code> is constant, after one step:</p>
<p><img src="../images/imu_ang_vel_int_step_1.png" alt="Angular velocity integration (1st step)"/></p>
<p>After 100 steps (1 second):</p>
<p><img src="../images/imu_ang_vel_int_step_100.png" alt="Angular velocity integration (after 100 steps)"/></p>
<h3 id="position-calculation"><a class="header" href="#position-calculation">Position Calculation:</a></h3>
<p>Velocity update:</p>
<p><img src="../images/imu_vel_update_step_1.png" alt="Velocity update, step 1"/></p>
<p>After the first step:</p>
<p><img src="../images/imu_vel_update_step_1_2.png" alt="Velocity update, step 1"/></p>
<p>Position update:</p>
<p><img src="../images/imu_pose_update_step_1.png" alt="Pose update, step 1"/></p>
<p>(Since initial velocity is zero, position doesn't change in the first iteration.)</p>
<p>Next step:</p>
<p><img src="../images/imu_vel_pose_update_step_2.png" alt="Velocity and pose update, step 2"/></p>
<h2 id="practical-considerations"><a class="header" href="#practical-considerations">Practical Considerations</a></h2>
<ul>
<li>Noise and Biases: Real IMU data is noisy. Integrating noisy data leads to drift. In practice, filtering (e.g., using a Kalman filter or complementary filter) is essential.</li>
<li>Gravity Compensation: If you are working in 3D, you must subtract the gravity vector from the accelerometer reading to isolate the linear acceleration. In 1D, if your axis is aligned vertically, you must subtract out <code>g = 9.81 m/s^2</code>. </li>
<li>Sampling Rate and Integration Method: We used a simple Euler method. More accurate integration schemes (e.g., trapezoidal, Runge-Kutta) can improve accuracy.</li>
</ul>
<h2 id="example-code"><a class="header" href="#example-code">Example Code</a></h2>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# Simulation parameters
fs = 100.0              # sampling frequency (Hz)
dt = 1.0/fs             # time step
t_end = 5.0             # total duration (s)
t = np.arange(0, t_end, dt)

# Given sensor readings (for demonstration)
omega = 0.1 * np.ones_like(t)  # rad/s
a = 0.2 * np.ones_like(t)       # m/s^2

# Initial conditions
theta_0 = 0.0
x_0 = 0.0
v_0 = 0.0

# Allocate arrays for orientation, velocity, and position
theta = np.zeros_like(t)
v = np.zeros_like(t)
x = np.zeros_like(t)

theta[0] = theta_0
v[0] = v_0
x[0] = x_0

# Numerical integration
for k in range(len(t)-1):
    # Integrate orientation
    theta[k+1] = theta[k] + omega[k]*dt

    # Integrate velocity
    v[k+1] = v[k] + a[k]*dt

    # Integrate position
    x[k+1] = x[k] + v[k]*dt

# Plot results
plt.figure(figsize=(12,6))

plt.subplot(3,1,1)
plt.plot(t, theta, label='Orientation (rad)')
plt.xlabel('Time (s)')
plt.ylabel('Theta (rad)')
plt.title('Orientation from Angular Velocity')

plt.subplot(3,1,2)
plt.plot(t, v, label='Velocity (m/s)')
plt.xlabel('Time (s)')
plt.ylabel('Velocity (m/s)')
plt.title('Velocity from Acceleration')

plt.subplot(3,1,3)
plt.plot(t, x, label='Position (m)')
plt.xlabel('Time (s)')
plt.ylabel('Position (m)')
plt.title('Position from Acceleration')

plt.tight_layout()
plt.show()
</code></pre>
<p><img src="../images/imu_plot.png" alt="Simulation plot"/></p>
<p>Tip: Try to add some random noise to measured signals.</p>
<h2 id="advanced-topics-future-robotics-courses"><a class="header" href="#advanced-topics-future-robotics-courses">Advanced Topics (future robotics courses)</a></h2>
<ul>
<li>Extend the logic to 3D, working with vectors and rotation representations (e.g., Euler angles, quaternions).</li>
<li>Implement filtering techniques to handle noise (e.g., a complementary filter to fuse accelerometer and gyroscope data).</li>
<li>Learn how to remove gravity from the accelerometer measurements in real-world scenarios.</li>
<li>Implement full 3D orientation estimation with drift compensation (lin acc to estimate gravity direction, gyro for quick orientation updates).</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="../../3_navigation/text/4_corridor_following.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="../../3_navigation/text/6_maze_escape.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="../../3_navigation/text/4_corridor_following.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="../../3_navigation/text/6_maze_escape.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
